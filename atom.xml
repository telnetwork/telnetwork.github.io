<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://telnetwork.github.io</id>
    <title>Gridea</title>
    <updated>2020-03-21T12:56:08.612Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://telnetwork.github.io"/>
    <link rel="self" href="https://telnetwork.github.io/atom.xml"/>
    <subtitle>æ¸©æ•…è€ŒçŸ¥æ–°</subtitle>
    <logo>https://telnetwork.github.io/images/avatar.png</logo>
    <icon>https://telnetwork.github.io/favicon.ico</icon>
    <rights>All rights reserved 2020, Gridea</rights>
    <entry>
        <title type="html"><![CDATA[CentOS 7 æºç ç¼–è¯‘ Nginx]]></title>
        <id>https://telnetwork.github.io/post/centos-7-yuan-ma-bian-yi-nginx/</id>
        <link href="https://telnetwork.github.io/post/centos-7-yuan-ma-bian-yi-nginx/">
        </link>
        <updated>2020-03-21T12:02:51.000Z</updated>
        <content type="html"><![CDATA[<h3 id="å®‰è£…ä¾èµ–è½¯ä»¶">å®‰è£…ä¾èµ–è½¯ä»¶</h3>
<blockquote>
<p>CentOS 7</p>
</blockquote>
<pre><code>yum -y install epel-release
yum update
yum -y install lua-devel patch libtool libtool-ltdl libtool-ltdl-devel libxslt-devel libxslt libxml2 libxml2-devel gd-devel gd GeoIP GeoIP-devel GeoIP-data gperftools gcc gcc-c++ zlib-devel zlib make cmake autoconf openssl openssl-devel libwebp-devel libwebp libvpx perl-devel perl-ExtUtils-Embed autoconf automake gnome-common
</code></pre>
<blockquote>
<p>Ubuntu</p>
</blockquote>
<pre><code>apt-get update
apt-get -y install libgd-dev build-essential zlib1g-dev libpcre3 libpcre3-dev libssl-dev libxslt1-dev libxml2-dev libgeoip-dev libgoogle-perftools-dev libperl-dev libtool openssl gcc g++ google-perftools
</code></pre>
<h3 id="pcre">PCRE</h3>
<pre><code class="language-c++">wget https://ftp.pcre.org/pub/pcre/pcre-8.41.tar.gz
tar -xf pcre-8.41.tar.gz -C /usr/local/ &amp;&amp; cd /usr/local/pcre-8.41
./configure --enable-utf8 ; echo $?     // --enable-utf8ï¼šå¯¹utf-8çš„æ”¯æŒ
make ; echo $?
make install ; echo $?
</code></pre>
<h3 id="openssl">openssl</h3>
<pre><code>wget https://github.com/openssl/openssl/archive/OpenSSL_1_1_1.tar.gz
tar -xf OpenSSL_1_1_1.tar.gz &amp;&amp; mv openssl-OpenSSL_1_1_1 /usr/local/openssl-1.1.1
</code></pre>
<h3 id="åˆ›å»º-nginx-è¿è¡Œç”¨æˆ·">åˆ›å»º Nginx è¿è¡Œç”¨æˆ·</h3>
<pre><code>groupadd www
useradd www -g www -s /sbin/nologin -M
</code></pre>
<h3 id="å®˜ç½‘ä¸‹è½½-nginx-æºç åŒ…">å®˜ç½‘ä¸‹è½½ Nginx æºç åŒ…</h3>
<pre><code>wget http://nginx.org/download/nginx-1.16.1.tar.gz
tar -xf nginx-1.16.1.tar.gz &amp;&amp; cd nginx-1.16*
</code></pre>
<h3 id="æ‰©å±•æ¨¡å—-1-headers">æ‰©å±•æ¨¡å— 1---- headers</h3>
<pre><code>git clone https://github.com/openresty/headers-more-nginx-module.git /usr/local/ngx_modules/ngx_headers
</code></pre>
<h3 id="æ‰©å±•æ¨¡å—-2-echo">æ‰©å±•æ¨¡å— 2 ---- echo</h3>
<pre><code>git clone https://github.com/openresty/echo-nginx-module.git /usr/local/ngx_modules/ngx_echo
</code></pre>
<h3 id="æ‰©å±•æ¨¡å—-3-brotli">æ‰©å±•æ¨¡å— 3 ---- brotli</h3>
<pre><code>git clone https://github.com/google/ngx_brotli.git /usr/local/ngx_modules/ngx_brotli
</code></pre>
<h3 id="æ‰©å±•æ¨¡å—-4-cloudflare-zlib">æ‰©å±•æ¨¡å— 4 ---- cloudflare-zlib</h3>
<pre><code>git clone https://github.com/cloudflare/zlib.git /usr/local/ngx_modules/cloudflare_zlib
</code></pre>
<h3 id="æ‰©å±•æ¨¡å—-5-sticky">æ‰©å±•æ¨¡å— 5 ---- sticky</h3>
<pre><code>wget https://bitbucket.org/nginx-goodies/nginx-sticky-module-ng/get/master.tar.gz
tar xf master.tar.gz
mv nginx-goodies-nginx-sticky-module-ng-08a395c66e42 /usr/local/ngx_modules/ngx_sticky
</code></pre>
<h3 id="æ‰©å±•æ¨¡å—-6-luajit">æ‰©å±•æ¨¡å— 6 ---- luajit</h3>
<pre><code>wget https://github.com/openresty/luajit2/archive/v2.1-20200102.tar.gz
tar xf v2.1-20200102.tar.gz &amp;&amp; mv luajit2-2.1-20200102 /usr/local/ngx_modules/luajit2-2.1
cd /usr/local/ngx_modules/luajit2-2.1
make &amp;&amp; make install
echo '/usr/local/lib' &gt;&gt; /etc/ld.so.conf.d/local.conf
export LUA_INCLUDE_DIR=/usr/local/include/luajit-2.1
ldconfig
</code></pre>
<h3 id="æ‰©å±•æ¨¡å—-7-lua-cjson">æ‰©å±•æ¨¡å— 7 ---- lua-cjson</h3>
<pre><code>wget https://github.com/openresty/lua-cjson/archive/2.1.0.7.tar.gz
tar xf 2.1.0.7.tar.gz &amp;&amp; mv lua-cjson-2.1.0.7 /usr/local/ngx_modules/
cd /usr/local/ngx_modules/lua-cjson-2.1.0.7
make &amp;&amp; make install
export LUAJIT_LIB=/usr/local/lib
export LUAJIT_INC=/usr/local/include/luajit-2.1
</code></pre>
<h3 id="æ‰©å±•æ¨¡å—-8-ngx_devel_kit">æ‰©å±•æ¨¡å— 8 ---- ngx_devel_kit</h3>
<pre><code>wget https://github.com/vision5/ngx_devel_kit/archive/v0.3.1.tar.gz
tar -xf v0.3.1.tar.gz  &amp;&amp; mv ngx_devel_kit-0.3.1 /usr/local/ngx_modules/
</code></pre>
<h3 id="æ‰©å±•æ¨¡å—-9-lua-nginx">æ‰©å±•æ¨¡å— 9 ---- lua-nginx</h3>
<pre><code>wget https://github.com/openresty/lua-nginx-module/archive/v0.10.14.tar.gz
tar -xf v0.10.14.tar.gz &amp;&amp; mv lua-nginx-module-0.10.14 /usr/local/ngx_modules/
</code></pre>
<h4 id="ä¸ºäº†æ–¹ä¾¿ä»¥åé‡æ–°ç¼–è¯‘nginxå°†luaå˜é‡å†™å…¥etcprofile-ä¸­">ä¸ºäº†æ–¹ä¾¿ä»¥åé‡æ–°ç¼–è¯‘Nginx,å°†luaå˜é‡å†™å…¥/etc/profile ä¸­</h4>
<pre><code>#Lua
export LUAJIT_LIB=/usr/local/lib
export LUAJIT_INC=/usr/local/include/luajit-2.1
export LUA_INCLUDE_DIR=/usr/local/include/luajit-2.1
</code></pre>
<h3 id="æ‰©å±•æ¨¡å—-10-tcmallocubuntu-ç³»ç»Ÿå¯ä»¥ç›´æ¥å¿½ç•¥è¯¥æ­¥éª¤ä»¥ä¸Šaptä¸­å·²å®‰è£…">æ‰©å±•æ¨¡å— 10  ---- TCMallocï¼›Ubuntu ç³»ç»Ÿå¯ä»¥ç›´æ¥å¿½ç•¥è¯¥æ­¥éª¤ï¼Œä»¥ä¸Šaptä¸­å·²å®‰è£…</h3>
<pre><code># å…ˆç¼–è¯‘å®‰è£…libunwind
wget http://mirror.yongbok.net/nongnu/libunwind/libunwind-1.1.tar.gz
tar -xf libunwind-1.1.tar.gz &amp;&amp; cd libunwind-1.1
CFLAGS=-fPIC ./configure
make CFLAGS=-fPIC
make CFLAGS=-fPIC install

wget https://github.com/gperftools/gperftools/archive/gperftools-2.7.tar.gz
tar -xf gperftools-2.7.tar.gz &amp;&amp; cd gperftools-gperftools-2.7/
./autogen.sh
./configure --enable-frame-pointers
make &amp;&amp; make install ; echo $?
# ç¼–è¯‘æ—¶æ·»åŠ  &quot;--with-google_perftools_module&quot;
# å°†TCMallocåº“åŠ è½½åˆ°Linuxç³»ç»Ÿä¸­
echo '/usr/local/lib' &gt;&gt; /etc/ld.so.conf.d/local.conf
ldconfig
</code></pre>
<h4 id="ç¼–è¯‘-nginx">ç¼–è¯‘ Nginx</h4>
<pre><code>./configure \
--add-module=/usr/local/ngx_modules/ngx_echo \
--add-module=/usr/local/ngx_modules/ngx_brotli \
--add-module=/usr/local/ngx_modules/ngx_concat \
--add-module=/usr/local/ngx_modules/ngx_headers_info \
--add-module=/usr/local/ngx_modules/ngx_sticky_goodies \
--add-module=/usr/local/ngx_modules/ngx_devel_kit-0.3.1 \
--add-module=/usr/local/ngx_modules/lua-nginx-module-0.10.14 \
--user=www \
--group=www \
--with-http_v2_module \
--with-http_ssl_module \
--with-http_flv_module \
--with-http_mp4_module \
--with-http_dav_module \
--with-http_sub_module \
--with-http_slice_module \
--with-http_geoip_module \
--with-http_realip_module \
--with-http_gunzip_module \
--with-http_addition_module \
--with-http_secure_link_module \
--with-http_stub_status_module \
--with-http_degradation_module \
--with-http_gzip_static_module \
--with-http_auth_request_module \
--with-http_image_filter_module \
--with-http_random_index_module \
--with-http_perl_module=dynamic \
--with-http_xslt_module=dynamic \
--with-stream \
--with-stream_realip_module \
--with-stream_ssl_module \
--with-stream_ssl_preread_module \
--with-stream_geoip_module \
--with-debug \
--with-compat \
--with-threads \
--with-file-aio \
--with-google_perftools_module \
--with-ld-opt=-ltcmalloc_minimal \
--with-zlib=/usr/local/ngx_modules/Cloudflare-zlib \
--with-pcre-jit \
--with-pcre-opt=-fPIC \
--with-pcre=/usr/local/pcre-8.41 \
--with-openssl=/usr/local/openssl-1.1.1 \
--with-openssl-opt='enable-tls1_3 -fPIC' \
--without-poll_module \
--without-select_module \
--without-http_scgi_module \
--without-http_uwsgi_module \
--prefix=/usr/local/nginx \
--sbin-path=/usr/local/nginx/sbin/nginx \
--conf-path=/usr/local/nginx/conf/nginx.conf \
--pid-path=/data/nginx/PID/nginx.pid \
--lock-path=/data/nginx/PID/nginx.lock \
--http-log-path=/data/nginx/logs/access.log \
--error-log-path=/data/nginx/logs/error.log \
--http-scgi-temp-path=/data/nginx/tmps/scgi \
--http-proxy-temp-path=/data/nginx/tmps/proxy \
--http-uwsgi-temp-path=/data/nginx/tmps/uwsgi \
--http-fastcgi-temp-path=/data/nginx/tmps/fastcgi \
--http-client-body-temp-path=/data/nginx/tmps/client_body ; echo $?


make -j 2 ; echo $?
make install ; echo $?

</code></pre>
<h4 id="åˆ›å»ºç›®å½•">åˆ›å»ºç›®å½•</h4>
<pre><code>mkdir -pv /data/nginx/{tcmalloc,logs/hack,PID,proxy_cache,proxy_temp,tmp/client_body,tmp/fastcgi}
chown -R www.www /data/
chmod 0777 /data/nginx/tcmalloc
</code></pre>
<h4 id="åˆ›å»º-systemd-æœåŠ¡æ–‡ä»¶">åˆ›å»º systemd æœåŠ¡æ–‡ä»¶</h4>
<pre><code class="language-c++"># CentOS
/usr/lib/systemd/system/nginx.service

# Ubuntu
/lib/systemd/system/nginx.service
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
tee /usr/lib/systemd/system/nginx.service &lt;&lt;-'EOF'
[Unit]
Description=The nginx HTTP and reverse proxy server
After=syslog.target network.target remote-fs.target nss-lookup.target

[Service]
Type=forking
PIDFile=/data/nginx/PID/nginx.pid
ExecStartPre=/bin/rm -f /data/nginx/PID/nginx.pid
ExecStartPre=/usr/local/nginx/sbin/nginx -t
ExecStart=/usr/local/nginx/sbin/nginx
ExecReload=/bin/kill -s HUP $MAINPID
ExecStop=/bin/kill -s QUIT $MAINPID
PrivateTmp=true

[Install]
WantedBy=multi-user.target
EOF

# æ³¨æ„äº‹é¡¹
# PIDFileï¼šè¦å’Œç¼–è¯‘æ—¶çš„é…ç½®ä¿æŒä¸€è‡´
# rmï¼šwhich rm
</code></pre>
<h4 id="ç®¡ç†">ç®¡ç†</h4>
<pre><code>systemctl daemon-reload
systemctl enable nginx
systemctl start nginx
systemctl stop nginx
systemctl restart nginx
systemctl reload nginx
systemctl force-reload nginx
systemctl status nginx
</code></pre>
<h4 id="æŒ‡å®šåŠ¨æ€æ¨¡å—è·¯å¾„">æŒ‡å®šåŠ¨æ€æ¨¡å—è·¯å¾„</h4>
<p><s>--modules-path=/usr/local/ngx_modules/dynamic</s></p>
<h2 id="ç¯‡å¹…å †çš„æœ‰ç‚¹å¤šæ¨¡å—é…ç½®è¿˜æ²¡æœ‰åŠ ä¸Šæœ‰æ—¶é—´åœ¨åˆ†å‰²å‡ºæ¥">ç¯‡å¹…å †çš„æœ‰ç‚¹å¤šï¼Œæ¨¡å—é…ç½®è¿˜æ²¡æœ‰åŠ ä¸Šï¼Œæœ‰æ—¶é—´åœ¨åˆ†å‰²å‡ºæ¥</h2>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Hello Gridea]]></title>
        <id>https://telnetwork.github.io/post/hello-gridea/</id>
        <link href="https://telnetwork.github.io/post/hello-gridea/">
        </link>
        <updated>2018-12-11T16:00:00.000Z</updated>
        <summary type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
]]></summary>
        <content type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
<!-- more -->
<p><a href="https://github.com/getgridea/gridea">Github</a><br>
<a href="https://gridea.dev/">Gridea ä¸»é¡µ</a><br>
<a href="http://fehey.com/">ç¤ºä¾‹ç½‘ç«™</a></p>
<h2 id="ç‰¹æ€§">ç‰¹æ€§ğŸ‘‡</h2>
<p>ğŸ“  ä½ å¯ä»¥ä½¿ç”¨æœ€é…·çš„ <strong>Markdown</strong> è¯­æ³•ï¼Œè¿›è¡Œå¿«é€Ÿåˆ›ä½œ</p>
<p>ğŸŒ‰  ä½ å¯ä»¥ç»™æ–‡ç« é…ä¸Šç²¾ç¾çš„å°é¢å›¾å’Œåœ¨æ–‡ç« ä»»æ„ä½ç½®æ’å…¥å›¾ç‰‡</p>
<p>ğŸ·ï¸  ä½ å¯ä»¥å¯¹æ–‡ç« è¿›è¡Œæ ‡ç­¾åˆ†ç»„</p>
<p>ğŸ“‹  ä½ å¯ä»¥è‡ªå®šä¹‰èœå•ï¼Œç”šè‡³å¯ä»¥åˆ›å»ºå¤–éƒ¨é“¾æ¥èœå•</p>
<p>ğŸ’»  ä½ å¯ä»¥åœ¨ <strong>Windows</strong>ï¼Œ<strong>MacOS</strong> æˆ– <strong>Linux</strong> è®¾å¤‡ä¸Šä½¿ç”¨æ­¤å®¢æˆ·ç«¯</p>
<p>ğŸŒ  ä½ å¯ä»¥ä½¿ç”¨ <strong>ğ–¦ğ—‚ğ—ğ—ğ—ğ–» ğ–¯ğ–ºğ—€ğ–¾ğ—Œ</strong> æˆ– <strong>Coding Pages</strong> å‘ä¸–ç•Œå±•ç¤ºï¼Œæœªæ¥å°†æ”¯æŒæ›´å¤šå¹³å°</p>
<p>ğŸ’¬  ä½ å¯ä»¥è¿›è¡Œç®€å•çš„é…ç½®ï¼Œæ¥å…¥ <a href="https://github.com/gitalk/gitalk">Gitalk</a> æˆ– <a href="https://github.com/SukkaW/DisqusJS">DisqusJS</a> è¯„è®ºç³»ç»Ÿ</p>
<p>ğŸ‡¬ğŸ‡§  ä½ å¯ä»¥ä½¿ç”¨<strong>ä¸­æ–‡ç®€ä½“</strong>æˆ–<strong>è‹±è¯­</strong></p>
<p>ğŸŒ  ä½ å¯ä»¥ä»»æ„ä½¿ç”¨åº”ç”¨å†…é»˜è®¤ä¸»é¢˜æˆ–ä»»æ„ç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼Œå¼ºå¤§çš„ä¸»é¢˜è‡ªå®šä¹‰èƒ½åŠ›</p>
<p>ğŸ–¥  ä½ å¯ä»¥è‡ªå®šä¹‰æºæ–‡ä»¶å¤¹ï¼Œåˆ©ç”¨ OneDriveã€ç™¾åº¦ç½‘ç›˜ã€iCloudã€Dropbox ç­‰è¿›è¡Œå¤šè®¾å¤‡åŒæ­¥</p>
<p>ğŸŒ± å½“ç„¶ <strong>Gridea</strong> è¿˜å¾ˆå¹´è½»ï¼Œæœ‰å¾ˆå¤šä¸è¶³ï¼Œä½†è¯·ç›¸ä¿¡ï¼Œå®ƒä¼šä¸åœå‘å‰ ğŸƒ</p>
<p>æœªæ¥ï¼Œå®ƒä¸€å®šä¼šæˆä¸ºä½ ç¦»ä¸å¼€çš„ä¼™ä¼´</p>
<p>å°½æƒ…å‘æŒ¥ä½ çš„æ‰åå§ï¼</p>
<p>ğŸ˜˜ Enjoy~</p>
]]></content>
    </entry>
</feed>